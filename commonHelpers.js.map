{"version":3,"file":"commonHelpers.js","sources":["../src/script.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nconst elements = {\n  form: document.querySelector('.search-form'),\n  list: document.querySelector('.gallery'),\n  btnLoadMore: document.querySelector('.js-load-more'),\n  guard: document.querySelector('.js-guard'),\n};\n\nelements.form.addEventListener('submit', handlerGetPhoto);\nelements.btnLoadMore.addEventListener('click', handlerGetMorePhoto);\nlet page = 1;\n// let options = {\n//   root: null,\n//   rootMargin: '300px',\n//   threshold: 1.0,\n// };\n// const observer = new IntersectionObserver(handlerLoadMore, options);\n\n// async function handlerLoadMore(entries) {\n//   entries.forEach(async entry => {\n//     if (entry.isIntersecting) {\n//       page += 1;\n//       if (page === 12) {\n//         alert(\"We're sorry, but you've reached the end of search results.\");\n//         observer.unobserve(elements.guard);\n//       }\n//       const search = elements.form.elements.searchQuery.value;\n//       const resp = await serviceImage(search, page);\n//       elements.list.insertAdjacentHTML('beforeend', createMarckup(resp.hits));\n//     }\n//   });\n// }\nasync function handlerGetMorePhoto(evt) {\n  page += 1;\n  const search = elements.form.elements.searchQuery.value;\n  const resp = await serviceImage(search, page);\n  const { hits, totalHits } = resp;\n  const totalPages = Math.ceil(totalHits / 40);\n  if (page >= totalPages) {\n    iziToast.show({\n      title: 'Hey',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n    elements.btnLoadMore.classList.replace('load-more', 'load-more-hidden');\n  } else {\n    elements.list.insertAdjacentHTML('beforeend', createMarckup(hits));\n  }\n}\n\nasync function handlerGetPhoto(evt) {\n  evt.preventDefault();\n  const value = evt.currentTarget.elements.searchQuery.value.trim();\n  if (value === '') {\n    return iziToast.show({\n      title: 'Hey',\n      message: 'You need to enter some words',\n    });\n  }\n  page = 1;\n  elements.list.innerHTML = '';\n  elements.btnLoadMore.classList.replace('load-more', 'load-more-hidden');\n  try {\n    const result = await serviceImage(value);\n    if (result.hits.length === 0) {\n      return iziToast.show({\n        title: 'Hey',\n        message:\n          '\"Sorry, there are no images matching your search query. Please try again.\"',\n      });\n    }\n    elements.list.insertAdjacentHTML('beforeend', createMarckup(result.hits));\n    elements.btnLoadMore.classList.replace('load-more-hidden', 'load-more');\n    // observer.observe(elements.guard);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n// async function serviceImage(value, page = 1) {\n//   const MAIN_URL = 'https://pixabay.com/api/';\n//   const params = new URLSearchParams({\n//     key: '40911522-ba38adab2f7d889473ea5ba96',\n//     q: value,\n//     image_type: 'photo',\n//     orientation: 'horizontal',\n//     safesearch: true,\n//     per_page: 40,\n//     page,\n//   });\n//   const resp = await fetch(`${MAIN_URL}?${params}`);\n//   if (!resp.ok) {\n//     throw new Error(resp.statusText);\n//   }\n//   return await resp.json();\n// }\n\nfunction createMarckup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <div class=\"photo-card\">\n    <img class=\"img-gallery\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes: ${likes}</b>\n        </p>\n            <p class=\"info-item\">\n        <b>Views: ${views}</b>\n        </p>\n        <p class=\"info-item\">\n            <b>Comments: ${comments}</b>\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads: ${downloads}</b>\n        </p>\n    </div>\n</div>`\n    )\n    .join('');\n}\nasync function serviceImage(value, page = 1) {\n  const MAIN_URL = 'https://pixabay.com/api/';\n  const params = new URLSearchParams({\n    key: '40911522-ba38adab2f7d889473ea5ba96',\n    q: value,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 40,\n    page,\n  });\n  const resp = await axios.get(`${MAIN_URL}?${params}`);\n  return resp.data;\n}\n"],"names":["elements","handlerGetPhoto","handlerGetMorePhoto","page","evt","search","resp","serviceImage","hits","totalHits","totalPages","iziToast","createMarckup","value","result","error","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","MAIN_URL","params","axios"],"mappings":"6vBAGA,MAAMA,EAAW,CACf,KAAM,SAAS,cAAc,cAAc,EAC3C,KAAM,SAAS,cAAc,UAAU,EACvC,YAAa,SAAS,cAAc,eAAe,EACnD,MAAO,SAAS,cAAc,WAAW,CAC3C,EAEAA,EAAS,KAAK,iBAAiB,SAAUC,CAAe,EACxDD,EAAS,YAAY,iBAAiB,QAASE,CAAmB,EAClE,IAAIC,EAAO,EAsBX,eAAeD,EAAoBE,EAAK,CACtCD,GAAQ,EACR,MAAME,EAASL,EAAS,KAAK,SAAS,YAAY,MAC5CM,EAAO,MAAMC,EAAaF,EAAQF,CAAI,EACtC,CAAE,KAAAK,EAAM,UAAAC,CAAW,EAAGH,EACtBI,EAAa,KAAK,KAAKD,EAAY,EAAE,EACvCN,GAAQO,GACVC,EAAS,KAAK,CACZ,MAAO,MACP,QAAS,4DACf,CAAK,EACDX,EAAS,YAAY,UAAU,QAAQ,YAAa,kBAAkB,GAEtEA,EAAS,KAAK,mBAAmB,YAAaY,EAAcJ,CAAI,CAAC,CAErE,CAEA,eAAeP,EAAgBG,EAAK,CAClCA,EAAI,eAAc,EAClB,MAAMS,EAAQT,EAAI,cAAc,SAAS,YAAY,MAAM,OAC3D,GAAIS,IAAU,GACZ,OAAOF,EAAS,KAAK,CACnB,MAAO,MACP,QAAS,8BACf,CAAK,EAEHR,EAAO,EACPH,EAAS,KAAK,UAAY,GAC1BA,EAAS,YAAY,UAAU,QAAQ,YAAa,kBAAkB,EACtE,GAAI,CACF,MAAMc,EAAS,MAAMP,EAAaM,CAAK,EACvC,GAAIC,EAAO,KAAK,SAAW,EACzB,OAAOH,EAAS,KAAK,CACnB,MAAO,MACP,QACE,4EACV,CAAO,EAEHX,EAAS,KAAK,mBAAmB,YAAaY,EAAcE,EAAO,IAAI,CAAC,EACxEd,EAAS,YAAY,UAAU,QAAQ,mBAAoB,WAAW,CAEvE,OAAQe,EAAP,CACA,QAAQ,IAAIA,CAAK,CAClB,CACH,CAoBA,SAASH,EAAcI,EAAK,CAC1B,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA;AAAA,oCAEwBN,WAAsBE;AAAA;AAAA;AAAA,wBAGlCC;AAAA;AAAA;AAAA,oBAGJC;AAAA;AAAA;AAAA,2BAGOC;AAAA;AAAA;AAAA,4BAGCC;AAAA;AAAA;AAAA,OAIvB,EACA,KAAK,EAAE,CACZ,CACA,eAAehB,EAAaM,EAAOV,EAAO,EAAG,CAC3C,MAAMqB,EAAW,2BACXC,EAAS,IAAI,gBAAgB,CACjC,IAAK,qCACL,EAAGZ,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAAV,CACJ,CAAG,EAED,OADa,MAAMuB,EAAM,IAAI,GAAGF,KAAYC,GAAQ,GACxC,IACd"}